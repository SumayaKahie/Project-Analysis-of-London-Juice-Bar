SELECT 
    s.store_name,
    SUM(t.net_sales_gbp) AS total_revenue
FROM transactions t
JOIN stores s 
    ON t.store_id = s.store_id
GROUP BY s.store_name
ORDER BY total_revenue DESC;
/*Soho and Tottenham Court Road generated the highest revenue, indicating strong demand in leisure and commuter-driven locations*/


 
 SELECT 
    p.product_name,
    SUM(t.net_sales_gbp) AS revenue,
    SUM(t.quantity_sold) AS units_sold
FROM transactions t
JOIN products p 
    ON t.product_id = p.product_id
GROUP BY p.product_name
ORDER BY revenue DESC;
/* ðŸ¥ˆ Question 2: Best & Worst Products This answers:
Which products perform best?
Which should be discontinued or promoted?*/


SELECT 
    s.store_name,
    CASE 
        WHEN t.is_weekend = 'TRUE' THEN 'Weekend'
        ELSE 'Weekday'
    END AS day_type,
    SUM(t.net_sales_gbp) AS revenue
FROM transactions t
JOIN stores s 
    ON t.store_id = s.store_id
GROUP BY s.store_name, t.is_weekend
ORDER BY s.store_name, day_type;

/* Weekend vs weekday demand by store
Tottenham Court Road â†’ strong weekdays
Soho â†’ strong weekends
Liverpool Street â†’ financial district pattern
Dean Street â†’ balanced demand */


SELECT 
    s.store_name,
    p.category,
    SUM(t.net_sales_gbp) AS revenue
FROM transactions t
JOIN stores s ON t.store_id = s.store_id
JOIN products p ON t.product_id = p.product_id
GROUP BY s.store_name, p.category
ORDER BY s.store_name, revenue DESC;
/*Product category performance by store. 
Coffee dominates commuter locations, while juices and smoothies perform better in tourist-heavy areas */


SELECT 
    s.store_name,
    t.hour_of_day,
    SUM(t.net_sales_gbp) AS revenue
FROM transactions t
JOIN stores s ON t.store_id = s.store_id
GROUP BY s.store_name, t.hour_of_day
ORDER BY s.store_name, revenue DESC;
/*Peak trading hours vary significantly by location, suggesting opportunities for staffing optimisation*/


